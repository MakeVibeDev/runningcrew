# 미션 참여 플로우 스펙 (v1)

## 1. 요구사항 요약
- 로그인한 사용자만 참여 버튼을 볼 수 있다.
- 해당 사용자가 크루 멤버인지 확인 후 참여/탈퇴 버튼을 노출한다.
- 기본 참여 상태는 `mission_participants` 테이블에 `status='joined'`로 기록.
- 버튼 상태는 `joined`/`left`/미참여에 따라 다르게 표현한다.
- 참/실/오너 관리 UI 및 참가자 목록 표시 등 순차적으로 확장.

## 2. RLS 정책
테이블: `mission_participants`
- **select**: 본인 또는 동일 크루 멤버.
- **insert**: 본인 + 동일 크루 멤버일 때만 허용.
- **update**: 본인 또는 크루 오너.
- **delete**: 크루 오너.

## 3. UI 플로우
1. 미션 카드 렌더링 시 참여자 수와 참여 상태를 읽어온다.
2. 참여 버튼(`MissionParticipationControl`)을 렌더링:
   - 로그인하지 않은 경우: 안내 문구.
   - 크루 멤버가 아닌 경우: "가입한 크루원만 참여 가능" 안내.
   - 멤버이자 참여 중 아닌 경우: `참여하기` 버튼 → insert
   - 참여중인 경우: `참여 취소` 버튼 → status='left'
3. 성공 시 상태/카운트를 즉시 갱신하고 `router.refresh()`로 서버 데이터 업데이트.

## 4. 후속 목표 (TODO)
- 참여자 목록 모달 (상위 N명 아바타 표시)
- 진행률 집계(참여자별 기록) 연동
- 오너 전용 bulk 관리 UI
